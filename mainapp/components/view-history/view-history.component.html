<div class="mt-3">
  <div class="position-relative clearfix">
    <div class="float-left">
      <h5 class="subtitle"><a [routerLink]="['/home']" href="javascript: void(0);" class="backLink"><i class="fas fa-chevron-circle-left"></i> &nbsp; </a>VM Configuration Setup</h5>
    </div>
    <div class="float-right position-relative rightBoxSearch mb-2">
      <input
        type="text" class="form-control searchTable"
        [(ngModel)]="searchText" autocomplete="off"
        placeholder="Search by Customer Name, SubscriptionID & Provider"
      />
      <i class="fa-solid fa-magnifying-glass fa-fw"></i>
    </div>
  </div>
  
  
 
  <div class="maincontainer">
    <div class="clearfix">
      <div class="float-right">
        <a href="javascript: void(0);" (click)="reloadData()"><i class="fas fa-sync"></i>&nbsp;Reload</a>
      </div>
    </div>
    <div class="row">
      <div class="col-12">
        <table class="table table-striped table-hover cstTable">
          <thead>
            <tr>
              <th scope="col">Transaction Id </th>
              <th scope="col">Customer Name </th>
              <th scope="col">Subscription Id</th>
              <th scope="col">Provider</th>
              <th scope="col">Created Date</th>
              <th scope="col">Source</th>
              <th scope="col">Target</th>
              <th scope="col">Status</th>
              <th scope="col">Action</th>
            </tr>
          </thead>
          <tbody> 
            <tr *ngFor="let transctions of transactionHistory | searchTable: {customerName:searchText, applicationId:searchText, provider: searchText}">
              <td>{{transctions.transactionId}}</td>
              <td>{{transctions.customerName}}</td>
              <td>{{transctions.applicationId}}</td>
              <td>{{transctions.provider}}</td>
              <td>{{transctions.createdDate | date: 'MM-dd-YYYY HH:MM'}}</td>
              <td>
                <a href="javascript: void(0);" (click)="sourceDataById(transctions.transactionId)" class="backLink">
                <i class="fa-regular fa-eye"></i>&nbsp;Json
                </a>
              </td>
              <td>
                <a href="javascript: void(0);" *ngIf="transctions.terraformScript != null" (click)="targetDataById(transctions.transactionId)" class="backLink">
                  <i class="fa-regular fa-eye"></i>&nbsp;Script
                </a>
                <strong  *ngIf="transctions.terraformScript == null">NA</strong>
              </td>
              <td class="text-primary">
                <span *ngIf="transctions.resourceStatus === 'SAVED TXN'" class="badge badge-warning fnt13px">Saved Txn</span>
                <!-- <span *ngIf="transctions.resourceStatus === 'NOT INITIATED'" class="badge badge-warning fnt13px">Incomplete</span> -->
                <span *ngIf="transctions.resourceStatus === 'DESTROYED'" class="badge badge-danger fnt13px">Destroyed</span>
                <span *ngIf="transctions.resourceStatus === 'CREATED'" class="badge badge-primary fnt13px">Created</span>
                <span *ngIf="transctions.resourceStatus === 'EXECUTED'" class="badge badge-success fnt13px">Executed</span>
              </td>
              <td >
                <a *ngIf="transctions.resourceStatus === 'SAVED TXN' || transctions.resourceStatus === 'CREATED'"  class="action-btn" (click)="OnEdit(transctions.transactionId)" href="javascript: void(0);">
                    <i class="fa-solid fa-pencil -icon--primary"></i>
                </a>
                &nbsp;
                <a class="action-btn" href="javascript: void(0);" *ngIf="transctions.resourceStatus === 'EXECUTED'"  (click)="OnDelete(transctions.transactionId)">
                    <i class="fa-regular fa-trash-can -icon--danger"></i>
                </a>
            </td>
              <ng-template #template1>
                <div class="modal-header">
                  <h4 class="modal-title pull-left">Source Data</h4>
                  <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef?.hide()">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <div class="fnt13px wrdBreak">
                    <pre class="sourceJson">{{this.resourceJson | json}}</pre>
                  </div>
                </div>
              </ng-template>
              <ng-template #template2>
                <div class="modal-header">
                  <h4 class="modal-title pull-left">Target Data</h4>
                  <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef?.hide()">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <div class="fnt13px wrdBreak">
                    <pre class="sourceJson" >{{this.targetJson }}</pre>
                  </div>
                </div>
              </ng-template>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="loaderBG" *ngIf="loader">
        <div class="loader"></div>
      </div>
    </div>
  </div>   
  <ng-template #destroy>
    <div class="modal-header">
      <h4 class="modal-title pull-left">Success</h4>
      <button type="button" class="close btn-close pull-right" aria-label="Close" (click)="modalRef?.hide()">
        <span aria-hidden="true" class="visually-hidden">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="fnt16px text-center">
        {{destroyedMsg}}
      </div>
    </div>
    <div class="col-md-12 text-center mt-4 mb-3">
      <button class="btn btnReset mr-2" (click)="modalRef?.hide()">Cancel</button>
      <button class="btn btnCustom mr-2"(click)="modalRef?.hide();reloadData();">OK</button>
    </div>
  </ng-template> 